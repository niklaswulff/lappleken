@model Lappleken.Web.Models.Game.GamePlayViewModel

<div class="status-bar row">
    <div class="col-xs-4">Fas: <span id="game-phase">Ett ord</span></div>
    <div class="col-xs-4">Spelare: @Model.PlayerName</div>
    <div class="col-xs-4">Lag @Model.TeamName</div>
</div>


<div id="play-game" class="action-menu row">
    <div class="col-xs-12 center">
        <button id="take-bowl">Ta skålen</button>
    </div>
</div>
<div id="lapp" class="lapp row" data-lapp-id="123">
    <div class="col-xs-12 center">
        <button id="get-first-lapp">Ta första</button>
        <span id="lapp-content">Abraham Lincoln</span>
    </div>
</div>
<div class="lapp-outcome">
    <button id="skip-lapp">Lägg tillbaka</button>
    <button id="claim-lapp">Tagen</button>
</div>
<script type="text/javascript">
    $(function () {
        function handleEvent(command) {
            var lappId = $('#lapp').data('lapp-id');

            $.post('/api/Play/Lapp/',
                {
                    command: command,
                    lappId: lappId
                }
            ).fail(function (msg) {
                alert('error ' + msg);
            }).done(function (response) {
                handleResponse(response);
            });
        }

        function handleResponse(response) {
            
            if (response == null) {
                alert('inga lappar kvar');
                return;
            }
            
            var lapp = $('#lapp');
            
            lapp.data('lapp-id', response.lappId);
            lapp.find('#lapp-content').text(response.lappContent);

        };

        $('#get-first-lapp').click(function () {

            $.get('/api/play/')
                .fail(function (msg) {
                    alert('error ' + msg);
                }).done(function (response) {

                    handleResponse(response);
                });

        });

        $('#take-bowl').click(function () {
        });


        $('#skip-lapp').click(function () {
            handleEvent('skip');
        });

        $('#claim-lapp').click(function () {
            handleEvent('claim');
        });
    }
    );
</script>
